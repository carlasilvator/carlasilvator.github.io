<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>بارت جديد - Toxic Rose</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo&display=swap" rel="stylesheet">

<style>
  body {
    background: #0a0a0a;
    color: #d9d9d9;
    font-family: 'Cairo', sans-serif;
    margin: 0; padding: 0;
    display: flex;
    justify-content: center;
    min-height: 100vh;
  }
  .container {
    max-width: 740px;
    width: 90%;
    background: #111;
    border: 1.5px solid #004466;
    box-shadow: 0 0 18px #007799, inset 0 0 10px #00bbff;
    padding: 30px 25px 60px 25px;
    margin: 20px 0;
    border-radius: 10px;
  }
  h2 {
    font-size: 1.8rem;
    color: #00d9ff;
    border-bottom: 2px solid #0077aa;
    padding-bottom: 12px;
    margin-bottom: 30px;
    user-select: none;
  }
  #raw-content {
    display: none;
  }
  .paragraph {
    position: relative;
    margin-bottom: 80px;
    font-size: 1.15rem;
    line-height: 1.9;
  }
  .paragraph p {
    margin: 0;
  }
  .comment-toggle-btn {
    position: absolute;
    top: 10px;
    right: 100%;
    margin-right: 12px;
    background: #004466;
    border: none;
    color: #00d9ff;
    font-weight: bold;
    border-radius: 50%;
    width: 38px;
    height: 38px;
    cursor: pointer;
    box-shadow: 0 0 12px #00d9ff;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.3rem;
    user-select: none;
  }
  .comment-toggle-btn:hover {
    background: #0077aa;
    box-shadow: 0 0 24px #00ffff;
  }
  .comments-section {
    position: absolute;
    top: 45px;
    right: 110%;
    width: 320px;
    max-height: 400px;
    overflow-y: auto;
    background: #121212;
    border: 1.5px solid #005577;
    border-radius: 12px;
    padding: 15px;
    display: none;
    box-shadow: 0 0 25px #00aaff;
    z-index: 1000;
    font-size: 0.95rem;
  }
  .comment {
    background: #1c1c1c;
    border-radius: 10px;
    padding: 10px 12px;
    margin-bottom: 12px;
    word-break: break-word;
  }
  .comment .user {
    font-weight: bold;
    margin-bottom: 6px;
    color: #00aaff;
    user-select: text;
  }
  .comment .text {
    margin-bottom: 8px;
    white-space: pre-wrap;
  }
  .comment .actions {
    display: flex;
    gap: 10px;
  }
  .comment button {
    background: transparent;
    border: none;
    color: #00aaff;
    font-size: 0.85rem;
    cursor: pointer;
    padding: 0;
    user-select: none;
  }
  .comment button:hover {
    color: #00ffff;
  }
  .reply-box {
    margin-top: 10px;
  }
  .reply-box textarea {
    width: 100%;
    height: 60px;
    border-radius: 10px;
    border: 1.8px solid #005577;
    background: #0a0a0a;
    color: #d9d9d9;
    padding: 8px;
    resize: none;
    font-family: 'Cairo', sans-serif;
  }
  .reply-box button {
    background: #00aaff;
    color: #000;
    border: none;
    border-radius: 8px;
    padding: 7px 14px;
    font-weight: bold;
    cursor: pointer;
    margin-top: 6px;
  }
  textarea.new-comment {
    width: 100%;
    height: 60px;
    border-radius: 10px;
    border: 1.8px solid #005577;
    background: #0a0a0a;
    color: #d9d9d9;
    padding: 8px;
    resize: none;
    margin-bottom: 10px;
    font-family: 'Cairo', sans-serif;
  }
  button.submit-comment {
    background: #00aaff;
    color: #000;
    border: none;
    border-radius: 8px;
    padding: 8px 16px;
    font-weight: bold;
    cursor: pointer;
  }
  button.submit-comment:disabled,
  textarea.new-comment:disabled {
    background: #222;
    color: #666;
    cursor: not-allowed;
  }
  #authButtons {
    text-align: center;
    margin-bottom: 20px;
    user-select: none;
  }
  #authButtons button {
    background: #005577;
    color: #fff;
    border: none;
    border-radius: 10px;
    padding: 10px 18px;
    margin: 0 6px;
    font-weight: bold;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  #authButtons button:hover {
    background: #0077aa;
  }
  #userInfo {
    display: block;
    margin-top: 12px;
    color: #00d9ff;
    font-weight: bold;
    user-select: text;
  }
  /* Scrollbar */
  .comments-section::-webkit-scrollbar,
  .comments-list::-webkit-scrollbar {
    width: 6px;
  }
  .comments-section::-webkit-scrollbar-thumb,
  .comments-list::-webkit-scrollbar-thumb {
    background-color: #00aaff;
    border-radius: 4px;
  }
  @media (max-width: 768px) {
    .container {
      width: 95%;
      margin: 15px 0;
      padding: 20px 15px 40px 15px;
      box-shadow: none;
    }
    .comment-toggle-btn {
      position: static;
      margin: 10px 0 8px 0;
      border-radius: 6px;
      width: auto;
      height: auto;
      padding: 6px 14px;
      font-size: 1.1rem;
    }
    .comments-section {
      position: static;
      width: 100%;
      max-height: 260px;
      box-shadow: none;
      border-radius: 10px;
      margin-top: 12px;
    }
    h2 {
      font-size: 1.5rem;
    }
    .paragraph {
      font-size: 1.05rem;
      margin-bottom: 60px;
    }
  }
  @media (max-width: 480px) {
    .container {
      padding: 16px 12px 30px 12px;
      border-width: 1px;
    }
    .paragraph {
      font-size: 1rem;
    }
  }
</style>
</head>
<body>

<div class="container">
  <h2>بيلادونا السامة</h2>

  <div id="authButtons">
    <button id="loginBtn">تسجيل الدخول بـ Google</button>
    <button id="logoutBtn" style="display:none;">تسجيل الخروج</button>
    <span id="userInfo"></span>
  </div>

  <div id="raw-content">

    ~المقدمة~

«كانت مثل البيلادونا تزهر في الظلام لتغري الناظرين بفتنة جمالها الساحر و تخفي بين طياتها سمها القاتل موقعة التائهين على أرض الجنون في فخوخها منتظرة وقت أقامة الحداد على أرواحهم المعذبة بسمومها»




أهلاً بك في أرض الجنون
يا من قررت بحماقة لذيذة أن تفتح روايتي
حيث المنطق يذبح و العُقلاء يؤكلون اولاً..






أن كنت قارئ بتفكير أجرامي و سايكو فـ رح تكون طبق التحلية على مائدتي لأن عقلك سيكون الألذ طعماً 



شدوا الأحزمة 
أو لا تفعلوا 
لكن لا تلوموني بعد سقوطكم 



لا تثق بأحد فكل شخصية هنا هي شيطان متنكر..
لا بطل ينقذ
و لا بطلة تبكي 
لا ضحية الكل مذنب
حتى أنت لأنك ستقرأ كل هذا الشر 
لأنك ستتأثر به 
أعلم هذا جيداً فأنا المخرجة كل شيء يسير حسب رغبتي وحدي



دعني أعطيك دورك ياعزيزي أنت الشاهد؟..

لا أسفة خليني أصحح أنت شاهد و مشارك رغماً عنك  في حرب لا قانون يحكمها بين هذه الشياطين، حرب العشق و السلطة جنون الهوس و الخيانات العظمى.. 





و يا أرواحي الشفقية أحذركم من زهرتي السامة لا تدعوها تسحركم و تقيم الحداد على أرواحكم المفتونة
لا تقتربوا
لا تنخدعوا 
و لا تقعوا بحبها
إلا أن رغبتم بأن تدفنوا أحياء هذا يعود لكم... 





حتى أن لم ترغب بالسقوط يؤسفني
أنك ستقع بالتأكيد.. 
الجميع يقع. 
بينما أنا أشاهدكم بأبتسامة

و كل هذا السقوط يجعلني اسأل هل البطلة تستحق ان تقعوا بحبها و تدفنوا أحياء لأجلها؟


أم أنكم ستكرهونها في النهاية و تندمون؟

دعوني أعرفكم على نفسي أنا آثير.. عنقاء الموت لست كاتبة أنا المخرجة الشريرة التي صنعت هذه المجزرة العاطفية

و كما يقولون أنا لست فنانة انا الفن السوداوي

و هذه هي زهرتي السامة روايتي الأولى من سلسلة 
_أبتسم أيها الشيطان.. 

الشيطان سيبتسم في النهاية لأنتصاره و هذه الكاتبة ستصفق له بحرارة









ملاحظات قبل البدء برحلة الهلاك:

•الرواية قد لا تناسب البعض لأحتوائها على تفاصيل دموية مفصلة و مشاهد حادة

•التصنيف: أكشن_غموض_ نفسي_خيال علمي _دموي _Dark romance دارك رومانس

من أعداء إلى أحباء ⟵ ثم من أحباء إلى أعداء 

 
•التنزيل حسب التفاعل ركزوا على هذه النقطة



•ان كنت تبحث عن رواية بعوالم وردية لطيفة فقد أخطأت العنوان كل ما يوجد هنا هو ورد سام بألوان زاهية لكنه قاتل 
لذا أخرج أن لم تكن من محبي الموت 
على أيدي كاتبة مهووسة بأكل عقول القراء




•المشاهد الجنسية غير موجودة أنا أرقى بكثير من هذا المستوى المتدني 


•الأنتقاد مقبول لكن بأحترام هذه روايتي مو مطعم طلبات يلبي رغباتك لذا لا تلبس قناع المهرج المتنكر بثوب الناقد أتفقنا؟


•جميع الحقوق محفوظة لي و الأقتباس دون أذني هو فعل غبي جداً لأنني سأمسح بكرامتك الأراضي و سأبدء بـ يا عزيزي و أختمها بقبلات حارة على جثة كرامتك القذرة



ڤولا يا أرواح الشفق و لا تنسوا أنا حذرتكم
أن كنت عاقل فأهرب 
و أن بقيت فأهلاً بك يسرني ان أبدأ بالتخطيط لرسم حبكة ستطبخ عقلك قبل وضعه هلى مائدتي


بدأت في: 27 أكتوبر /عام 2024

تاريخ الأنتهاء: حينما تصبح مهووساً
باللعنات التي أكتبها 
الضحية أنت 
المذنبة انا التي تعشق أكل عقول القراء

. 

  </div>

  <div id="rendered-content"></div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

<script>
  // إعداد Firebase - حطي مفاتيح مشروعك هنا
  const firebaseConfig = {
    apiKey: "AIzaSyBtTc7yWNfNkG0oVSbpq0V9A6DHTgZoGBM",
    authDomain: "works-rawan.firebaseapp.com",
    projectId: "works-rawan",
    storageBucket: "works-rawan.firebasestorage.app",
    messagingSenderId: "986254083746",
    appId: "1:986254083746:web:17f7db0389c94473f0b9fb"
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  let currentUser = null;

  const loginBtn = document.getElementById('loginBtn');
  const logoutBtn = document.getElementById('logoutBtn');
  const userInfo = document.getElementById('userInfo');

  auth.onAuthStateChanged(user => {
    currentUser = user;
    if(user) {
      loginBtn.style.display = 'none';
      logoutBtn.style.display = 'inline-block';
      userInfo.textContent = `مرحباً، ${user.displayName || user.email}`;
      enableCommentBoxes(true);
    } else {
      loginBtn.style.display = 'inline-block';
      logoutBtn.style.display = 'none';
      userInfo.textContent = '';
      enableCommentBoxes(false);
    }
  });

  loginBtn.onclick = () => {
    const provider = new firebase.auth.GoogleAuthProvider();
    auth.signInWithPopup(provider).catch(console.error);
  };
  logoutBtn.onclick = () => auth.signOut();

  function enableCommentBoxes(enable) {
    const newCommentBoxes = document.querySelectorAll('textarea.new-comment');
    const submitButtons = document.querySelectorAll('button.submit-comment');
    newCommentBoxes.forEach(box => box.disabled = !enable);
    submitButtons.forEach(btn => btn.disabled = !enable);
  }

  // توليد الفقرات من النص الخام
  function renderParagraphs(partId) {
    const rawContent = document.getElementById('raw-content').textContent.trim();
    const paragraphs = rawContent.split(/\n\s*\n/); // تقسيم عند سطر فارغ

    const container = document.getElementById('rendered-content');
    container.innerHTML = '';

    paragraphs.forEach((text, index) => {
      const paraId = `${partId}-para-${index+1}`;

      // إنشاء div الفقرة
      const paraDiv = document.createElement('div');
      paraDiv.className = 'paragraph';
      paraDiv.id = paraId;

      // نص الفقرة
      const p = document.createElement('p');
      p.textContent = text.trim();
      paraDiv.appendChild(p);

      // زر تعليق
      const btn = document.createElement('button');
      btn.className = 'comment-toggle-btn';
      btn.title = 'تعليقات';
      btn.textContent = '💬';
      btn.onclick = () => toggleComments(paraId);
      paraDiv.appendChild(btn);

      // قسم التعليقات (مخفي بالبداية)
      const commentsSection = document.createElement('div');
      commentsSection.className = 'comments-section';
      commentsSection.id = 'comments-' + paraId;

      const commentsList = document.createElement('div');
      commentsList.className = 'comments-list';
      commentsSection.appendChild(commentsList);

      // صندوق التعليق الجديد
      const newComment = document.createElement('textarea');
      newComment.className = 'new-comment';
      newComment.placeholder = 'اكتب تعليقك هنا...';
      newComment.disabled = !currentUser;
      commentsSection.appendChild(newComment);

      const submitBtn = document.createElement('button');
      submitBtn.className = 'submit-comment';
      submitBtn.textContent = 'أرسل';
      submitBtn.disabled = !currentUser;
      submitBtn.onclick = () => submitComment(paraId);
      commentsSection.appendChild(submitBtn);

      paraDiv.appendChild(commentsSection);
      container.appendChild(paraDiv);
    });
  }

  // تحميل التعليقات لكل فقرة
  function loadComments(paraId) {
    const commentsList = document.querySelector(`#comments-${paraId} .comments-list`);
    if(!commentsList) return;

    commentsList.innerHTML = 'جاري التحميل...';

    db.collection("comments")
      .where("paragraphId", "==", paraId)
      .orderBy("timestamp", "asc")
      .get()
      .then(querySnapshot => {
        commentsList.innerHTML = '';
        const comments = [];
        const repliesMap = {};

        querySnapshot.forEach(doc => {
          const data = doc.data();
          data.id = doc.id;
          comments.push(data);
          if(data.parentId){
            if(!repliesMap[data.parentId]) repliesMap[data.parentId] = [];
            repliesMap[data.parentId].push(data);
          }
        });

        comments.filter(c => !c.parentId).forEach(c => {
          commentsList.appendChild(createCommentElement(c, repliesMap));
        });
      })
      .catch(error => {
        commentsList.innerHTML = '';
        console.error("خطأ بتحميل التعليقات:", error);
      });
  }

  // إنشاء عنصر التعليق (مع دعم الردود)
  function createCommentElement(commentData, repliesMap, level=0) {
    const div = document.createElement('div');
    div.className = 'comment';
    div.style.marginLeft = (level * 20) + 'px';

    const userSpan = document.createElement('div');
    userSpan.className = 'user';
    userSpan.textContent = commentData.userEmail || 'مجهول';
    div.appendChild(userSpan);

    const textSpan = document.createElement('div');
    textSpan.className = 'text';
    textSpan.textContent = commentData.text;
    div.appendChild(textSpan);

    const actionsDiv = document.createElement('div');
    actionsDiv.className = 'actions';

    // زر الرد
    const replyBtn = document.createElement('button');
    replyBtn.textContent = 'رد';
    replyBtn.onclick = () => toggleReplyBox(div, commentData);
    actionsDiv.appendChild(replyBtn);

    // تعديل وحذف لصاحب التعليق فقط
    if(currentUser && commentData.userId === currentUser.uid){
      const editBtn = document.createElement('button');
      editBtn.textContent = 'تعديل';
      editBtn.onclick = () => {
        const newText = prompt('عدّل تعليقك:', commentData.text);
        if(newText !== null && newText.trim() !== ''){
          db.collection('comments').doc(commentData.id).update({ text: newText.trim() })
            .then(() => loadComments(commentData.paragraphId));
        }
      };
      actionsDiv.appendChild(editBtn);

      const delBtn = document.createElement('button');
      delBtn.textContent = 'حذف';
      delBtn.onclick = () => {
        if(confirm('هل تريد حذف هذا التعليق؟')){
          db.collection('comments').doc(commentData.id).delete()
            .then(() => loadComments(commentData.paragraphId));
        }
      };
      actionsDiv.appendChild(delBtn);
    }

    div.appendChild(actionsDiv);

    // إضافة الردود أسفل التعليق
    if(repliesMap[commentData.id]){
      repliesMap[commentData.id].forEach(reply => {
        div.appendChild(createCommentElement(reply, repliesMap, level + 1));
      });
    }

    return div;
  }

  // إظهار وإخفاء صندوق الرد
  function toggleReplyBox(commentDiv, commentData) {
    const existingBox = commentDiv.querySelector('.reply-box');
    if(existingBox){
      existingBox.remove();
      return;
    }

    const box = document.createElement('div');
    box.className = 'reply-box';

    const textarea = document.createElement('textarea');
    textarea.placeholder = 'اكتب ردك هنا...';
    box.appendChild(textarea);

    const sendBtn = document.createElement('button');
    sendBtn.textContent = 'أرسل الرد';
    sendBtn.onclick = () => {
      const val = textarea.value.trim();
      if(!val){
        alert('اكتب رد قبل الإرسال');
        return;
      }
      if(!currentUser){
        alert('لازم تسجل الدخول لتكتب رد');
        return;
      }
      db.collection('comments').add({
        paragraphId: commentData.paragraphId,
        text: val,
        userId: currentUser.uid,
        userEmail: currentUser.email,
        timestamp: firebase.firestore.FieldValue.serverTimestamp(),
        parentId: commentData.id
      }).then(() => {
        loadComments(commentData.paragraphId);
      }).catch(e => {
        alert('خطأ بإرسال الرد');
        console.error(e);
      });
      box.remove();
    };
    box.appendChild(sendBtn);

    commentDiv.appendChild(box);
  }

  // إرسال تعليق جديد على فقرة
  function submitComment(paraId) {
    const para = document.getElementById(paraId);
    if (!para) return;

    const textarea = para.querySelector('textarea.new-comment');
    if (!textarea) return;

    const text = textarea.value.trim();
    if(text === ''){
      alert('اكتب تعليق قبل الإرسال');
      return;
    }
    if(!currentUser){
      alert('لازم تسجل الدخول لتكتب تعليق');
      return;
    }
    db.collection('comments').add({
      paragraphId: paraId,
      text: text,
      userId: currentUser.uid,
      userEmail: currentUser.email,
      timestamp: firebase.firestore.FieldValue.serverTimestamp()
    }).then(() => {
      textarea.value = '';
      loadComments(paraId);
    }).catch(e => {
      alert('خطأ بإنشاء التعليق');
      console.error(e);
    });
  }

  // إظهار أو إخفاء قسم التعليقات عند الضغط على زر التعليقات
  function toggleComments(paraId) {
    const section = document.getElementById('comments-' + paraId);
    if (!section) return;
    if (section.style.display === 'none' || section.style.display === '') {
      section.style.display = 'block';
      loadComments(paraId);
    } else {
      section.style.display = 'none';
    }
  }

  // أول ما تحمل الصفحة، نولد الفقرات مع التعليقات (غيري 'part1' إذا البارت اسم تاني)
  document.addEventListener('DOMContentLoaded', () => {
  renderParagraphs('intro'); // ✅ هذا هو التعديل الصح
});
  
</script>

</body>
  </html>
