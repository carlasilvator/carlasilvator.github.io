<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>تابعني | آثيريات العنقاء</title>
  <link href="https://fonts.googleapis.com/css2?family=Amiri&display=swap" rel="stylesheet" />
  <style>
    :root {
      --space-bg-dark: radial-gradient(ellipse at bottom, #020611, #05030c, #000);
      --star-color: rgba(0, 191, 255, 0.08);
      --text-primary: #cfefff;
      --text-secondary: #7dd3fc;
      --text-accent: #38bdf8;
      --link-color: #60a5fa;
      --link-hover-color: #93c5fd;
      --button-bg: #0f172a;
      --button-hover-bg: #1e293b;
      --glow-color: #3b82f6;
    }
    html {
      scroll-behavior: smooth;
    }
    body {
      margin: 0;
      font-family: 'Amiri', serif;
      background: radial-gradient(ellipse at bottom, #020611 0%, #05030c 35%, #000000 100%);
      background-size: 400% 400%;
      animation: spaceWave 60s ease infinite;
      color: var(--text-primary);
      overflow-x: hidden;
      min-height: 100vh;
      position: relative;
    }
    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      z-index: 0;
      background-image:
        radial-gradient(circle at 20% 30%, rgba(255, 180, 255, 0.3) 2px, transparent 3px),
        radial-gradient(circle at 50% 60%, rgba(255, 200, 255, 0.2) 1.5px, transparent 2px),
        radial-gradient(circle at 80% 40%, rgba(255, 160, 255, 0.25) 2.5px, transparent 3px),
        radial-gradient(circle at 70% 80%, rgba(255, 220, 255, 0.18) 1.8px, transparent 2px);
      background-size: 250px 250px;
      animation: starsGlitter 120s linear infinite;
    }
    @keyframes spaceWave {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    @keyframes starsGlitter {
      0% { background-position: 0 0, 0 0, 0 0, 0 0; }
      100% { background-position: -2000px 2000px, 1500px -1000px, -1600px 1600px, 1200px -900px; }
    }
    header {
      width: 100%;
      background: rgba(2, 6, 23, 0.9);
      border-bottom: 2px solid var(--glow-color);
      box-shadow: 0 0 15px var(--glow-color);
      backdrop-filter: blur(6px);
      text-align: center;
      position: relative;
      z-index: 10000;
      padding: 0;
    }
    .logo-wrapper {
      pointer-events: none;
      user-select: none;
      -webkit-user-drag: none;
      width: 100%;
      max-width: 100%;
      margin: 0 auto;
    }
    .logo-wrapper img {
      width: 100%;
      height: auto;
      display: block;
      object-fit: cover;
      max-height: 240px;
    }
    .main-nav {
      display: flex;
      overflow-x: auto;
      white-space: nowrap;
      padding: 8px 10px;
      background: rgba(2, 6, 23, 0.9);
      border-top: 1px solid var(--glow-color);
      border-bottom: 2px solid var(--glow-color);
      box-shadow: 0 0 10px var(--glow-color);
      scrollbar-width: thin;
      scrollbar-color: var(--glow-color) transparent;
    }
    .main-nav a {
      display: inline-block;
      color: var(--link-color);
      padding: 8px 14px;
      text-decoration: none;
      font-weight: bold;
      font-size: 15px;
      margin-right: 10px;
      white-space: nowrap;
      transition: color 0.3s, text-shadow 0.3s;
      flex-shrink: 0;
    }
    .main-nav a:hover {
      color: var(--link-hover-color);
      text-shadow: 0 0 5px var(--link-hover-color), 0 0 15px var(--link-hover-color);
      text-decoration: underline;
    }
    main.follow-container {
      max-width: 400px;
      margin: 40px auto 80px;
      background: rgba(2, 6, 23, 0.6);
      border-radius: 15px;
      padding: 28px 22px;
      box-shadow: 0 0 25px var(--glow-color);
      text-align: center;
      position: relative;
      z-index: 10;
    }
    .profile-pic {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      border: 3px solid var(--glow-color);
      margin: 0 auto 30px;
      box-shadow: 0 0 30px var(--glow-color), 0 0 60px var(--glow-color);
      display: block;
      object-fit: cover;
      pointer-events: none;
      user-select: none;
      transition: transform 0.4s ease;
    }
    .profile-pic:hover {
      transform: scale(1.1) rotate(4deg);
      box-shadow: 0 0 40px #e0aaff;
    }
    h1 {
      font-size: 26px;
      font-weight: 900;
      color: var(--text-secondary);
      letter-spacing: 1px;
      text-shadow: 0 0 15px var(--text-secondary);
      margin-bottom: 15px;
    }
    p.description {
      color: var(--text-accent);
      font-style: italic;
      margin-bottom: 25px;
      text-shadow: 0 0 8px var(--text-accent);
    }
    .intro-card {
      margin-top: 40px;
      padding: 22px;
      background: linear-gradient(145deg, rgba(2, 6, 23, 0.6), rgba(2, 6, 23, 0.8));
      border: 1px solid var(--glow-color);
      border-radius: 16px;
      box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
    }
    .intro-content {
      font-size: 17px;
      line-height: 1.9;
      color: var(--text-secondary);
      text-align: center;
      text-shadow: 0 0 8px rgba(59, 130, 246, 0.3);
    }
    footer {
      background: rgba(2, 6, 23, 0.7);
      color: var(--text-secondary);
      font-size: 12px;
      padding: 15px;
      text-align: center;
      border-top: 1px solid var(--glow-color);
      margin-top: 40px;
    }
  </style>
</head>
<body>
  <header>
    <div class="logo-wrapper">
      <img src="https://i.ibb.co/jkcmR2L0/Picsart-25-06-28-13-01-01-547.jpg" alt="شعار آثيريات العنقاء" />
    </div>
  </header>

  <nav class="main-nav">
    <a href="index.html">🏠 الرئيسية</a>
    <a href="https://www.instagram.com/carlasilvator" target="_blank">📸 أنستغرامي</a>
    <a href="follow-me.html">هنا آثير</a>
  </nav>

  <main class="follow-container">
    <img src="https://i.ibb.co/zWRM2b7m/1de6ccc21de5e0914dac28ab320d17cd.jpg" alt="صورة آثير" class="profile-pic" loading="lazy" />
    <h1>آثيريات العنقاء</h1>
    <button id="loginBtn">✨ اشتركي الآن</button>
    <button id="logoutBtn" style="display:none;">🚪 تسجيل الخروج</button>
    <div id="userInfo"></div>
    <p id="subscriberCount" style="margin-top: 20px; font-size: 18px; color: var(--text-secondary); text-shadow: 0 0 10px var(--text-accent);">
      عدد الأرواح الشفقية: ...
    </p>
  </main>

  <div class="intro-card">
    <div class="intro-content">
      ڤولا… يا روح الشفق.<br><br>
      دعني أخلع القناع للحظة، لا لأكون صادقة، بل لأزيد ارتباكك.<br><br>
      اسمي روان، لكنك ستعرفني تحت مسمى آخر… <strong>آثير</strong>.<br>
      كاتبة؟ مخرجة؟ مجرمة؟ جلادة؟ لا يهم.<br>
      فأنا… انعكاس لما تخشاه، أو ما تحتاجه، أو ما تهرب منه.<br><br>
      أكون لكل واحد منكم شيئًا مختلفًا.<br>
      قد أكون منقذك، وقد أكون نهايتك.<br><br>
      أنا أراك… أرعَاك… أراقب كل حرف ينبض فيك حين تقرأ كلماتي.<br><br>
      أنتم لستم قرّائي.<br>
      أنتم <em>أرواحي الشفقية</em>، وقود ناري، وصدى صوتي في هذه المتاهة التي تسمّونها "رواية".
    </div>
  </div>

  <footer>
    حقوق النشر محفوظة، وكل استخدام غير مرخص يعرض صاحبه للمساءلة القانونية — &copy; 2025
  </footer>
<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

<script>
// ========== تهيئة Firebase ==========
const firebaseConfig = {
  apiKey: "AIzaSyBtTc7yWNfNkG0oVSbpq0V9A6DHTgZoGBM",
  authDomain: "works-rawan.firebaseapp.com",
  projectId: "works-rawan",
  storageBucket: "works-rawan.appspot.com",
  messagingSenderId: "986254083746",
  appId: "1:986254083746:web:17f7db0389c94473f0b9fb"
};

if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

let currentUser = null;

// ========== DOM Elements ==========
const loginBtn = document.getElementById("loginBtn");
const logoutBtn = document.getElementById("logoutBtn");
const userInfo = document.getElementById("userInfo");
const countElem = document.getElementById("subscriberCount");

// ========== عرض عدد المشتركين ==========
async function updateSubscriberCount() {
  try {
    const snapshot = await db.collection("users").get();
    const count = snapshot.size;
    if (countElem) countElem.textContent = `عدد الأرواح الشفقية: ${count}`;
  } catch (e) {
    console.warn("فشل في جلب عدد المشتركين", e);
  }
}

// ========== جلب الاسم المستعار ==========
async function getAlias(uid) {
  try {
    const doc = await db.collection("users").doc(uid).get();
    return doc.exists ? doc.data().alias : null;
  } catch (e) {
    console.error("فشل في جلب الاسم المستعار", e);
    return null;
  }
}

// ========== عرض نافذة إدخال الاسم المستعار ==========
function showAliasModal() {
  return new Promise((resolve) => {
    const modal = document.createElement("div");
    modal.style.cssText = `
      position: fixed; top:0; left:0; width:100%; height:100%;
      background: rgba(0,0,0,0.75); display:flex; justify-content:center; align-items:center;
      z-index: 9999;
    `;
    modal.innerHTML = `
      <div style="background:#0f172a; padding:20px; border-radius:8px; max-width: 320px; width: 90%; color:#cfefff; font-family: sans-serif;">
        <h3 style="margin-top:0; margin-bottom:10px;">اختر اسمك المستعار</h3>
        <input type="text" id="aliasInput" placeholder="الاسم المستعار" style="width:100%; padding:8px; border-radius:4px; border:none; font-size:1rem;" />
        <div style="margin-top:10px; text-align:right;">
          <button id="aliasCancel" style="margin-right:8px; padding:6px 12px; border:none; border-radius:4px; background:#f87171; color:#fff; cursor:pointer;">إلغاء</button>
          <button id="aliasSubmit" style="padding:6px 12px; border:none; border-radius:4px; background:#38bdf8; color:#0f172a; cursor:pointer;">تأكيد</button>
        </div>
        <p id="aliasError" style="color:#f87171; margin-top:8px; display:none;"></p>
      </div>
    `;
    document.body.appendChild(modal);

    const input = modal.querySelector("#aliasInput");
    const submitBtn = modal.querySelector("#aliasSubmit");
    const cancelBtn = modal.querySelector("#aliasCancel");
    const errorP = modal.querySelector("#aliasError");

    input.focus();

    function cleanUp() {
      modal.remove();
      window.removeEventListener("keydown", onKeyDown);
    }

    function onKeyDown(e) {
      if (e.key === "Escape") {
        cleanUp();
        resolve(null);
      }
    }

    window.addEventListener("keydown", onKeyDown);

    cancelBtn.onclick = () => {
      cleanUp();
      resolve(null);
    };

    submitBtn.onclick = () => {
      const val = input.value.trim();
      if (val.length < 2) {
        errorP.style.display = "block";
        errorP.textContent = "الاسم المستعار قصير جداً، جرب مرة أخرى.";
        input.focus();
        return;
      }
      cleanUp();
      resolve(val);
    };
  });
}

// ========== حفظ الاسم المستعار ==========
async function requestAlias(uid) {
  const alias = await showAliasModal();
  if (!alias) {
    alert("الاسم المستعار مطلوب لتسجيل الدخول. سيتم تسجيل الخروج.");
    await auth.signOut();
    return null;
  }
  await db.collection("users").doc(uid).set({
    alias,
    createdAt: firebase.firestore.FieldValue.serverTimestamp()
  });
  return alias;
}

// ========== عند تغيير حالة المستخدم ==========
auth.onAuthStateChanged(async user => {
  currentUser = user;

  if (user) {
    if (loginBtn) loginBtn.style.display = "none";
    if (logoutBtn) logoutBtn.style.display = "inline-block";

    let alias = await getAlias(user.uid);
    if (!alias) {
      alias = await requestAlias(user.uid);
      if (!alias) return;
    }

    if (userInfo) userInfo.textContent = `مرحباً، ${alias}`;
    updateSubscriberCount();
  } else {
    if (loginBtn) loginBtn.style.display = "inline-block";
    if (logoutBtn) logoutBtn.style.display = "none";
    if (userInfo) userInfo.textContent = "";
    if (countElem) countElem.textContent = "عدد الأرواح الشفقية: ...";
  }
});

// ========== تسجيل الدخول ==========
if (loginBtn) {
  loginBtn.onclick = () => {
    const provider = new firebase.auth.GoogleAuthProvider();
    auth.signInWithPopup(provider).catch(console.error);
  };
}

// ========== تسجيل الخروج ==========
if (logoutBtn) {
  logoutBtn.onclick = () => auth.signOut();
}
</script>
  
</body>
</html>
